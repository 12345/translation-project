h1. お好みの IDE を設定しよう


"Eclipse":#eclipse | "Netbeans":#netbeans | "IntelliJ IDEA":#intellij | "Textmate":#textmate | "Other IDEs":#custom

play と共に作業することは簡単です。play が自動的にソースファイルに加えられた変更をコンパイルしてリフレッシュするので、高性能な IDE を必要としません。 シンプルなテキストエディタを使って簡単に作業することができます。

とは言え、近頃の Java IDE は自動補完、逐次コンパイル、リファクタリングやデバッグのアシストと言ったクールで生産的な機能を提供します。Play は "Netbeans":http://www.netbeans.org, "IntelliJ IDEA":http://www.jetbrains.com/idea/index.html と "Eclipse":http://www.eclipse.org プラットフォームをサポートします。


h2(#eclipse). <a>eclipse 設定ファイルの生成</a>

Play は Eclipse の設定を簡易化するコマンドを提供しています。play アプリケーションを動作する Eclipse プロジェクトに変換するには、 **eclipsify** コマンドを使用してください:

bc. # play eclipsify myApp

その後、 **File/Import/General/Existing project...** メニューから Workspace にアプリケーションをインポートする必要があります。

!images/eclipse!

**eclipsify** コマンドはアプリケーションにいくつかのランチャを生成します。ランチャは eclipse の **Run As** コマンドで実行するだけで利用できます。"Connect JPDA launcher" を "Debug As" から使用することで、いつでもデバッグセッションを始めることができます。サーバを起動したままでデバッグセッションを終了することができます。

classpath の変更のような重要な変更をアプリケーションへ加えるときは、設定ファイルを再生成するために **eclipsify** を再度実行します。

加えて、Play の配布物中の **support/eclipse** ディレクトリにある Eclipse プラグインを利用することができます。プラグインをインストールするには、単に jar ファイルを Eclipse インストールパスにあるはずの **dropins** フォルダにコピーします。

p(note). **チームで作業しているときは eclipse 設定ファイルをコミットしないこと！**
 
生成した設定ファイルには play フレームワークインストールパスへの絶対参照が含まれています。これはあなた自身のインストール作業に特化したものです。チームで作業するときは、それぞれの開発者は自分の eclipse 設定ファイルを個人で管理しなければなりません。

h2(#netbeans). <a>NetBeans 設定ファイルの生成</a>

play は Netbeans の設定を簡易化するコマンドを提供しています。play アプリケーションを妥当な Netbeans プロジェクトに変換するには、 **netbeansify** コマンドを使用してください:

bc. # play netbeansify myApp

その後は、そのアプリケーションをそのまま Netbeans プロジェクトとして開くことができます。

!images/netbeans!

アプリケーションを開始するには、標準の "Run" ボタンを使用してください。アプリケーションが起動されていれば、いつでも "Debug" ボタンを使ってデバッグセッションをアタッチすることができます。デバッグセッションを終了してもサーバは止まりません。

classpath の変更のような重要な変更をアプリケーションへ加えるときは、設定ファイルを再生成するために **netbeansify** を再度実行します。

p(note). **チームで作業しているときは nbproject ディレクトリルをコミットしないこと！**
 
生成した設定ファイルには play フレームワークインストールパスへの絶対参照が含まれています。これはあなた自身のインストール作業に特化したものです。チームで作業するときは、それぞれの開発者は自分の Netbeans 設定ファイルを個人で管理しなければなりません。

h2(#intellij). <a>IntelliJ IDEA 設定ファイルの生成</a>

play は IntelliJ IDEA の設定を簡易化するコマンドを提供しています。play アプリケーションを妥当な IntelliJ IDEA プロジェクトまたはモジュールに変換するには、 **idealize** コマンドを使用してください:

bc. # play idealize myApp

その後、モジュールインポート機能を使ってアプリケーションを InelliJ にインポートすることができます。

!images/intellij!

実行とデバッグはコンテキストメニューから実行できます。

p(note). **チームで作業しているときは .iml ファイルをコミットしないこと！**
 
生成した設定ファイルには play フレームワークインストールパスへの絶対参照が含まれています。これはあなた自身のインストール作業に特化したものです。チームで作業するときは、それぞれの開発者は自分の IntelliJ IDEA 設定ファイルを個人で管理しなければなりません。


h2(#textmate). <a>Textmate</a>

シンタックスハイライトとオートコンプリートが使える "Textmate":http://macromates.com/ 用に提供されたバンドルをダウンロードしてインストールすることができます。このバンドルによって、コントローラとビュー間を容易に行き来することもできます。

!images/editor!



h2(#custom). <a>お好みのエディタの手動設定</a>

play アプリケーションは標準的な Java アプリケーションであり、お好みのエディタを使って作業をするためにどんな特定のプラグインも必要としません。ただし、その場合は Play がどのように動作しているかについて、ほんのちょっとの知識を必要とします:

h3. Classpath 設定

play アプリケーションのクラスパスは以下の通り (この順で) 構築されます:

* **/conf** ディレクトリ
* **$PLAY_PATH/framework/play.jar**
* **/lib** ディレクトリ内のすべての jar ファイル
* **$PLAY_PATH/framework/lib** ディレクトリ内のすべての jar ファイル

p(note). *Tip*
 
モジュールを利用する場合にも、$module/lib からモジュールライブラリをクラスパスに追加する必要があります。


h3. 実行する Main クラス

play アプリケーションを開始するには、 **play.server.Server** クラスを実行するだけです。Play は実行するアプリケーションの場所を見つけるために **"application.path"** システムプロパティを使用します。通常、以下のようにしてこの値を渡します:

bc. java -Dapplication.path="/app/path"...


h3. Java agent

HotSwap リロードを有効にするためには、Java agent を **play.jar** ライブラリに組み込む必要があります。通常は以下のようにします:

bc. java -javaagent:"$PLAY_PATH/framework/play.jar" ...

これは必須ではありませんが、これが利用可能であるとき、クラスのリロードが高速になるでしょう。


h2. <a>デバッグ問題</a>

Java ソースが変更されたとき、Play は自動的に Java クラスをリロードします。しかし、Java はクラスのリロードを完全にサポートしていないので、JDPA デバッグは容易に混乱します: コードをステップインしたときに、ブレークポイントの設定に失敗したり、デバッガが間違った行で止まるかもしれません。

これを避けるよりよい方法は、コードを変更した後にデバッグセッションを新規に開始することです。幸運なことに、JPDA は JVM を再起動することなく、いつでも接続したり、切断することができます。

以上より、デバッグにおける正しいワークフローは次のようになります:

* ソースコードを変更します。
* 結果を見るためにブラウザをリフレッシュします。 (このとき Play は変更内容をリロードして JVM 上のクラスを再定義します)
* 何かがおかしくデバッグする必要がある場合は、新しいデバッグセッションを開始します。
* コードをデバッグして、修正します。
* デバッガを切断します。

このワークフローを使用することによって、JVM にロードされたコードとデバッガを常に同期させることができます。

